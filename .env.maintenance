# ============================================================================
# MAINTENANCE AND RESOURCE LIMITS
# ============================================================================
# This file contains recommended settings to prevent disk space issues
# Merge these values into your main .env file
# ============================================================================

# ==========================
# PROMETHEUS CONFIGURATION
# ==========================
# Reduce retention from default to prevent disk bloat
PROMETHEUS_RETENTION_TIME=15d
# Set size limit (0 = unlimited, recommended: 10GB = 10GB)
PROMETHEUS_RETENTION_SIZE=10GB
# Limit concurrent queries
PROMETHEUS_QUERY_MAX_CONCURRENCY=10
PROMETHEUS_QUERY_TIMEOUT=1m
PROMETHEUS_QUERY_MAX_SAMPLES=10000000
PROMETHEUS_WEB_MAX_CONNECTIONS=256

# ==========================
# VICTORIAMETRICS CONFIGURATION
# ==========================
# Reduce retention from 1 year to prevent disk bloat
VICTORIAMETRICS_RETENTION_PERIOD=60d
# Limit memory usage
VICTORIAMETRICS_MEMORY_ALLOWED_PERCENT=40
# Reduce concurrent requests
VICTORIAMETRICS_SEARCH_MAX_CONCURRENT_REQUESTS=4
VICTORIAMETRICS_INSERT_MAX_CONCURRENT_REQUESTS=16
# Limit query memory
VICTORIAMETRICS_SEARCH_MAX_MEMORY_PER_QUERY=512MB
VICTORIAMETRICS_SEARCH_MAX_QUERY_DURATION=15s

# ==========================
# GRAFANA CONFIGURATION
# ==========================
# Enable log rotation
GF_LOG_MODE=console file
GF_LOG_LEVEL=info
# Clean temporary data
GF_PATHS_TEMP_DATA_LIFETIME=12h

# ==========================
# LOKI CONFIGURATION
# ==========================
# Limit retention
LOKI_RETENTION_PERIOD=30d
# Limit ingestion rate
LOKI_LIMITS_INGESTION_RATE_MB=4
LOKI_LIMITS_INGESTION_BURST_SIZE_MB=6

# ==========================
# STREMTHRU CONFIGURATION
# ==========================
# Limit log level to reduce verbosity
STREMTHRU_LOG_LEVEL=INFO
# Enable cache cleanup (if supported)
STREMTHRU_CACHE_TTL=86400

# ==========================
# OPEN-WEBUI CONFIGURATION
# ==========================
# Limit model cache size
OPEN_WEBUI_MAX_UPLOAD_SIZE=25
# Enable automatic cleanup
OPEN_WEBUI_ENABLE_CLEANUP=true

# ==========================
# PLEX CONFIGURATION
# ==========================
# Enable transcoder temp cleanup
PLEX_PREFERENCE_TranscoderTempDirectory=/tmp
PLEX_PREFERENCE_EnableTranscoderTempCleanup=1

# ==========================
# DOCKER LOGGING DEFAULTS
# ==========================
# These are set in daemon.json, but can be overridden per-service
DOCKER_LOG_MAX_SIZE=10m
DOCKER_LOG_MAX_FILE=3
DOCKER_LOG_COMPRESS=true

